<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Love Message</title>

  <style>
    body {
      margin: 0;
      background: #ffc0cb; /* nền hồng */
      color: white;
      font-family: Arial, sans-serif;
      overflow: hidden;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      flex-direction: column;
    }

    #passwordBox {
      text-align: center;
    }

    #loveText {
      font-size: 22px;
      color: red;
      width: 90%;
      max-width: 600px;
      margin: 20px auto;
      display: none;
      white-space: pre-line;
    }

    canvas {
      position: fixed;
      top: 0;
      left: 0;
    }

    #success {
      color: red;
      margin-top: 10px;
      display: none;
    }

    input, button {
      padding: 10px;
      font-size: 18px;
      border-radius: 5px;
      border: none;
    }

    button {
      background: #ff4d81;
      color: #fff;
      cursor: pointer;
    }

  </style>
</head>

<body>

<div id="passwordBox">
  <h2>Nhập mật khẩu ( Gợi ý: Ngày sinh anh và em ):</h2>
  <input type="password" id="pw" placeholder="••••">
  <button onclick="checkPW()">OK</button>
  <p id="wrong" style="color:red; display:none;">Sai mật khẩu!</p>
</div>

<canvas id="heartCanvas"></canvas>

<div id="loveText"></div>
<p id="success">— Anh yêu em —</p>

<audio id="bgm" src="perfect.mp3" autoplay loop></audio>

<script>
function checkPW() {
  const pw = document.getElementById("pw").value;
  if (pw === "1514") {
    document.getElementById("passwordBox").style.display = "none";
    startTyping();
    startHeart();
    document.getElementById("bgm").volume = 0.7;
    document.getElementById("bgm").play().catch(()=>{});
  } else {
    document.getElementById("wrong").style.display = "block";
  }
}

// ---------------------- HIỆU ỨNG GÕ TỪNG CHỮ ----------------------

const message = `Hey girl!

Today is yours and so is every day after this.
I just want to tell you that you're amazing,
and I'm always here for you ❤️`;

let index = 0;

function startTyping() {
  const textBox = document.getElementById("loveText");
  textBox.style.display = "block";

  const typer = setInterval(() => {
    textBox.textContent += message[index];
    index++;

    if (index >= message.length) {
      clearInterval(typer);
      document.getElementById("success").style.display = "block";
    }
  }, 40); // tốc độ 40ms mỗi ký tự
}

// ---------------------- HIỆU ỨNG TRÁI TIM ----------------------

function startHeart() {
  const canvas = document.getElementById("heartCanvas");
  const ctx = canvas.getContext("2d");

  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;

  const hearts = [];

  function random(min, max) {
    return Math.random() * (max - min) + min;
  }

  function Heart() {
    this.x = random(0, canvas.width);
    this.y = canvas.height + 20;
    this.size = random(10, 30);
    this.speed = random(1, 3);
    this.alpha = 1;
  }

  Heart.prototype.draw = function () {
    ctx.save();
    ctx.globalAlpha = this.alpha;
    ctx.fillStyle = "red";
    ctx.beginPath();
    ctx.moveTo(this.x, this.y);
    ctx.bezierCurveTo(this.x - this.size, this.y - this.size,
                      this.x - this.size * 1.5, this.y + this.size / 3,
                      this.x, this.y + this.size);
    ctx.bezierCurveTo(this.x + this.size * 1.5, this.y + this.size / 3,
                      this.x + this.size, this.y - this.size,
                      this.x, this.y);
    ctx.fill();
    ctx.restore();
  };

  Heart.prototype.update = function () {
    this.y -= this.speed;
    this.alpha -= 0.01;
  };

  function animate() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    if (Math.random() < 0.3) hearts.push(new Heart());

    hearts.forEach((h, i) => {
      h.update();
      h.draw();
      if (h.alpha <= 0) hearts.splice(i, 1);
    });

    requestAnimationFrame(animate);
  }

  animate();
}
</script>

</body>
</html>

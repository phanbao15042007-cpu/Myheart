<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Love Message</title>

  <style>
    body {
      margin: 0;
      background: #ffc0cb; /* nền hồng */
      color: white;
      font-family: Arial, sans-serif;
      overflow: hidden;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      flex-direction: column;
    }

    #passwordBox {
      text-align: center;
    }

    #loveText {
      font-size: 22px;
      color: red;
      width: 90%;
      max-width: 650px;
      margin: 20px auto;
      display: none;
      white-space: pre-line;
    }

    /* --- TIME FOOTER --- */
    #timeTogether {
      color: #b30000;
      font-size: 20px;
      display: none;
      font-weight: bold;

      position: fixed;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      text-align: center;
      width: 100%;
    }

    canvas {
      position: fixed;
      top: 0;
      left: 0;
    }

    #success {
      color: red;
      margin-top: 10px;
      display: none;
      font-size: 24px;
      font-weight: bold;
    }

  </style>
</head>

<body>

<div id="passwordBox">
  <h2>Nhập mật khẩu ( Gợi ý: ngày sinh anh và em ):</h2>
  <input type="password" id="pw" placeholder="••••" style="padding:10px;font-size:18px;">
  <button onclick="checkPW()" style="padding:10px 20px;font-size:18px;">OK</button>
  <p id="wrong" style="color:red; display:none;">Sai mật khẩu!</p>
</div>

<canvas id="heartCanvas"></canvas>

<div id="loveText"></div>
<p id="success">— Anh yêu em —</p>

<p id="timeTogether"></p>

<audio id="bgm" src="perfect.mp3" autoplay loop></audio>

<script>
// ----------------------------- CHECK PASSWORD -----------------------------
function checkPW() {
  const pw = document.getElementById("pw").value;
  if (pw === "1514") {
    document.getElementById("passwordBox").style.display = "none";
    startTyping();
    startHeart();
    startCountTime();

    const bgm = document.getElementById("bgm");
    bgm.volume = 0.7;
    bgm.play().catch(() => {});
  } else {
    document.getElementById("wrong").style.display = "block";
  }
}

// ----------------------------- HIỆU ỨNG GÕ TỪNG CHỮ -----------------------------

const message = `Hey girl!

Today is yours and so is every other day!
Give me a password to log into your heart :)
If anyone asks me what I like, I will answer out loud that I like you!
I love you for no reason, because you are yourself!
Having been with me for so long, have you liked me?
If you don’t mind, be my lover!
I won’t tell you that I like you. ♥
Give me your answer! ♥
My heart sobs because of you! ♥`;

let index = 0;

function startTyping() {
  const textBox = document.getElementById("loveText");
  textBox.style.display = "block";

  const typer = setInterval(() => {
    textBox.textContent += message[index];
    index++;

    if (index >= message.length) {
      clearInterval(typer);
      document.getElementById("success").style.display = "block";
      document.getElementById("timeTogether").style.display = "block";
    }
  }, 100); // tốc độ gõ chữ
}

// ----------------------------- THỜI GIAN BÊN NHAU -----------------------------

function startCountTime() {
  const startDate = new Date("2025-07-07T00:00:00");

  function updateTime() {
    const now = new Date();
    let diff = Math.floor((now - startDate) / 1000);

    if (diff < 0) diff = 0;

    let days = Math.floor(diff / 86400);
    diff %= 86400;

    let hours = Math.floor(diff / 3600);
    diff %= 3600;

    let mins = Math.floor(diff / 60);
    let secs = diff % 60;

    document.getElementById("timeTogether").innerHTML =
      `❤️ Chúng ta đã bên nhau: ${days} ngày ${hours} giờ ${mins} phút ${secs} giây ❤️`;
  }

  updateTime();
  setInterval(updateTime, 1000);
}

// ----------------------------- HIỆU ỨNG TRÁI TIM BAY -----------------------------

function startHeart() {
  const canvas = document.getElementById("heartCanvas");
  const ctx = canvas.getContext("2d");

  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;

  const hearts = [];

  function random(min, max) {
    return Math.random() * (max - min) + min;
  }

  function Heart() {
    this.x = random(0, canvas.width);
    this.y = canvas.height + 20;
    this.size = random(10, 30);
    this.speed = random(1, 3);
    this.alpha = 1;
  }

  Heart.prototype.draw = function () {
    ctx.save();
    ctx.globalAlpha = this.alpha;
    ctx.fillStyle = "red";
    ctx.beginPath();
    ctx.moveTo(this.x, this.y);
    ctx.bezierCurveTo(this.x - this.size, this.y - this.size,
                      this.x - this.size * 1.5, this.y + this.size / 3,
                      this.x, this.y + this.size);
    ctx.bezierCurveTo(this.x + this.size * 1.5, this.y + this.size / 3,
                      this.x + this.size, this.y - this.size,
                      this.x, this.y);
    ctx.fill();
    ctx.restore();
  };

  Heart.prototype.update = function () {
    this.y -= this.speed;
    this.alpha -= 0.01;
  };

  function animate() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    if (Math.random() < 0.3) hearts.push(new Heart());

    hearts.forEach((h, i) => {
      h.update();
      h.draw();
      if (h.alpha <= 0) hearts.splice(i, 1);
    });

    requestAnimationFrame(animate);
  }

  animate();
}
</script>

</body>
</html>

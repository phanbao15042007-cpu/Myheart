<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Love Message</title>

  <style>
    body {
      margin: 0;
      background: #ffc0cb;
      color: white;
      font-family: Arial, sans-serif;
      overflow-x: hidden;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding-top: 40px;
      padding-bottom: 80px; /* CHỪA CHỖ CHO FOOTER */
      min-height: 100vh;
      position: relative;
    }

    #passwordBox {
      text-align: center;
      z-index: 5;
    }

    #loveText {
      font-size: 22px;
      color: red;
      width: 90%;
      max-width: 650px;
      margin-top: 20px;
      display: none;
      white-space: pre-line;
      text-align: center;
      z-index: 5;
    }

    #success {
      color: red;
      margin-top: 10px;
      display: none;
      font-size: 24px;
      font-weight: bold;
      z-index: 5;
    }

    /* FOOTER THỜI GIAN */
    #timeTogether {
      position: fixed;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 20px;
      font-weight: bold;
      color: #b30000;
      display: block;
      z-index: 10; /* ĐÈ LÊN CANVAS */
      text-align: center;
      width: 100%;
    }

    /* Canvas nằm dưới không che chữ */
    canvas {
      position: fixed;
      top: 0;
      left: 0;
      pointer-events: none; /* Không chặn chữ */
      z-index: 1;
    }
  </style>
</head>

<body>

<div id="passwordBox">
  <h2>Nhập mật khẩu ( Gợi ý: ngày sinh anh và em ):</h2>
  <input type="password" id="pw" placeholder="••••" style="padding:10px;font-size:18px;">
  <button onclick="checkPW()" style="padding:10px 20px;font-size:18px;">OK</button>
  <p id="wrong" style="color:red; display:none;">Sai mật khẩu!</p>
</div>

<canvas id="heartCanvas"></canvas>

<div id="loveText"></div>
<p id="success">— Anh yêu em —</p>

<p id="timeTogether"></p>

<audio id="bgm" src="perfect.mp3" autoplay loop></audio>

<script>
function checkPW() {
  const pw = document.getElementById("pw").value;
  if (pw === "1514") {
    document.getElementById("passwordBox").style.display = "none";
    startTyping();
    startHeart();
    startCountTime();

    const bgm = document.getElementById("bgm");
    bgm.volume = 0.7;
    bgm.play().catch(() => {});
  } else {
    document.getElementById("wrong").style.display = "block";
  }
}

const message = `Tròn ơi!

Càm ơn em đã đi với anh quãng đường vừa qua tuỳ không dài nhưng cũng đủ để ta hiểu nhau hơn.
Em với anh cũng đã khó khăn mới đi với nhau tới đây thì đừng dễ bỏ cuộc em nha sắp tới chắc sẽ nhiều khó khăn á nhưng anh vẫn sẽ ăn đồ tròn nấu hâhha toàn đồ ngon.
Anh còn nhỏ lắm muốn bám đít em hoài hoài cơ về với em nó bình yên mà nhẹ lòng anh thích cảm giác đó lắm á
Anh sẽ làm cho bọn ghét anh phải nề vì quen em là xứng đáng bọn nó ko có cửa ahhaa♥
Mình cũg cố gắng đạt được nhiều mục tiêu với nhau nhaa. Anh với em cũng đã trải qua nhiều cảm xúc với nhau rồi nhưng anh mong tình yêu vẫn sẽ như lúc đầu em nha ♥
Anh yêu em lắm cô vợ bé bỏng của anh.
Gửi the love of my life ♥`;

let index = 0;

function startTyping() {
  const textBox = document.getElementById("loveText");
  textBox.style.display = "block";

  const typer = setInterval(() => {
    textBox.textContent += message[index];
    index++;

    if (index >= message.length) {
      clearInterval(typer);
      document.getElementById("success").style.display = "block";
      document.getElementById("timeTogether").style.display = "block";
    }
  }, 100);
}

function startCountTime() {
  const startDate = new Date("2025-07-07T00:00:00");

  function updateTime() {
    const now = new Date();
    let diff = Math.floor((now - startDate) / 1000);
    if (diff < 0) diff = 0;

    let days = Math.floor(diff / 86400);
    diff %= 86400;

    let hours = Math.floor(diff / 3600);
    diff %= 3600;

    let mins = Math.floor(diff / 60);
    let secs = diff % 60;

    document.getElementById("timeTogether").innerHTML =
      `❤️ Chúng ta đã bên nhau: ${days} ngày ${hours} giờ ${mins} phút ${secs} giây ❤️`;
  }

  updateTime();
  setInterval(updateTime, 1000);
}

function startHeart() {
  const canvas = document.getElementById("heartCanvas");
  const ctx = canvas.getContext("2d");

  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;

  const hearts = [];

  function random(min, max) {
    return Math.random() * (max - min) + min;
  }

  function Heart() {
    this.x = random(0, canvas.width);
    this.y = canvas.height + 20;
    this.size = random(10, 30);
    this.speed = random(1, 3);
    this.alpha = 1;
  }

  Heart.prototype.draw = function () {
    ctx.save();
    ctx.globalAlpha = this.alpha;
    ctx.fillStyle = "red";
    ctx.beginPath();
    ctx.moveTo(this.x, this.y);
    ctx.bezierCurveTo(this.x - this.size, this.y - this.size,
      this.x - this.size * 1.5, this.y + this.size / 3,
      this.x, this.y + this.size);
    ctx.bezierCurveTo(this.x + this.size * 1.5, this.y + this.size / 3,
      this.x + this.size, this.y - this.size,
      this.x, this.y);
    ctx.fill();
    ctx.restore();
  };

  Heart.prototype.update = function () {
    this.y -= this.speed;
    this.alpha -= 0.01;
  };

  function animate() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    if (Math.random() < 0.3) hearts.push(new Heart());

    hearts.forEach((h, i) => {
      h.update();
      h.draw();
      if (h.alpha <= 0) hearts.splice(i, 1);
    });

    requestAnimationFrame(animate);
  }

  animate();
}
</script>

</body>
</html>
